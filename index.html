<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Order Pad</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="app-header">
    <h1>Order Pad</h1>
    <div class="header-controls">
      <select id="templateSelect" class="template-select header-template-select"></select>
      <input type="text" id="templateNameInput" class="template-name-input" placeholder="or type name..." autocomplete="off" />
      <button class="btn small" id="loadTemplateBtn" title="Load selected template">Load</button>
      <span class="header-divider"></span>
      <button class="btn tab-btn active" data-tab="ordering" id="orderingTab">Order</button>
      <button class="btn tab-btn" data-tab="menu" id="menuTab">Edit Menu</button>
    </div>
  </div>

  <!-- Menu Editing Tab -->
  <div id="menuTabContent" class="tab-content">
    <div class="menu-grid">
      <!-- Menu Items Panel -->
      <div class="panel menu-items-panel">
        <div class="panel-header">
          <h2>Menu Items</h2>
          <div class="panel-actions">
            <button class="btn danger" id="resetDefaultBtn">Reset to defaults</button>
          </div>
        </div>
        
        <div class="add-item-section">
          <h3 class="collapsible-header" id="groupsHeader">
            <span class="collapse-icon">‚ñ∂</span> Groups
          </h3>
          <div id="groupsCollapsible" class="collapsible-content" style="display: none;">
            <div class="add-item-form">
              <input id="newGroupOrder" type="number" placeholder="Order #" style="width: 80px;" />
              <input id="newGroupName" placeholder="Group name" />
              <button class="btn primary" id="addGroupBtn">Add group</button>
            </div>
            <div id="groupsEditor" style="margin-top: 12px;"></div>
          </div>
        </div>

        <div class="add-item-section">
          <h3 class="collapsible-header" id="specialsHeader">
            <span class="collapse-icon">‚ñ∂</span> Specials
          </h3>
          <div id="specialsCollapsible" class="collapsible-content" style="display: none;">
            <div class="add-item-form">
              <input id="newSpecialName" placeholder="Special name" />
              <input id="newSpecialPrice" type="number" placeholder="Price" step="0.01" />
              <select id="newSpecialGroupSelect" style="flex: 1;">
                <option value="">No Group</option>
              </select>
              <input id="newSpecialColor" type="color" value="#dc2626" class="color-picker" title="Special color" />
              <button class="btn primary" id="addSpecialBtn">Add special</button>
            </div>
            <div id="specialsEditor" style="margin-top: 12px;"></div>
          </div>
        </div>

        <div class="add-item-section">
          <h3>Add New Item</h3>
          <div class="add-item-form">
            <input id="newName" placeholder="Item name" />
            <input id="newPrice" type="number" placeholder="Price" step="0.01" />
            <select id="newGroupSelect" style="flex: 1;">
              <option value="">No Group</option>
            </select>
            <input id="newColor" type="color" value="#6b7280" class="color-picker" title="Item color" />
            <button class="btn primary" id="addItemBtn">Add item</button>
          </div>
        </div>

        <div class="items-list">
          <h3>Current Items</h3>
          <div id="itemsEditor"></div>
        </div>
      </div>

      <!-- Menu Management Panel -->
      <div class="panel menu-management-panel">
        <div class="panel-header">
          <h2>Menu Management</h2>
        </div>

        <div class="section">
          <h3>Save & Load</h3>
          <div class="control-group">
            <button class="btn" id="saveMenuBtn">Save menu to file</button>
            <button class="btn" id="loadMenuBtn">Load menu from file</button>
            <input type="file" id="menuFileInput" accept=".json" style="display: none;" />
          </div>
        </div>

        <div class="section">
          <h3>Receipt Settings</h3>
          <div class="control-group">
            <label>Receipt Title</label>
            <input id="receiptTitle" value="Receipt" style="flex: 1;" />
          </div>
        </div>

        <div class="section">
          <h3>Menu JSON</h3>
          <div class="control-group">
            <textarea id="menuJsonText" rows="12" placeholder="Paste menu JSON here..." style="width: 100%; font-family: monospace; font-size: 12px; resize: vertical;"></textarea>
          </div>
          <div class="control-group">
            <button class="btn primary" id="loadJsonBtn">Load from JSON</button>
            <button class="btn" id="copyJsonBtn">Copy JSON</button>
          </div>
          <div class="muted">
            üí° Menu changes update the JSON above automatically. Click "Load from JSON" to apply changes from the textbox.
          </div>
        </div>

        <div class="help-text">
          <div class="muted">
            üí° Tip: All changes are automatically saved to your browser.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Ordering Tab -->
  <div id="orderingTabContent" class="tab-content active">
    <div class="ordering-grid">
      <div class="panel order-panel">
        <div class="panel-header">
          <h2>Place Order</h2>
          <div class="panel-actions">
            <button class="btn last-order" id="lastOrderBtn" title="Repeat last order" style="display:none;">‚Ü© Last order</button>
            <button class="btn danger" id="clearOrderBtn">Clear order</button>
          </div>
        </div>

        <div class="menu-items">
          <div class="search-bar-wrap" id="searchWrap">
            <span class="search-icon">üîç</span>
            <input type="text" class="search-bar" id="searchBar" placeholder="Search menu items..." autocomplete="off" />
            <button class="search-clear" id="searchClear">&times;</button>
          </div>
          <div id="itemButtons" class="item-buttons"></div>
          <div id="noResults" class="no-results" style="display:none;">
            <span class="no-results-icon">üîé</span>
            No items match your search.
          </div>
        </div>

        <div class="current-order">
          <h3>Current Order</h3>
          <div id="orderTableWrap"></div>
        </div>
      </div>

      <div class="panel receipt-panel">
        <div class="panel-header sticky-total">
          <h2>Receipt</h2>
          <div class="panel-actions">
            <button class="btn primary" id="copyBtn">Copy receipt</button>
            <button class="btn" id="selectBtn">Select all</button>
          </div>
        </div>
        
        <div class="total-display">
          <span id="totalLine" class="total-amount"></span>
        </div>
        
        <div class="control-group" style="margin-bottom: 8px;">
          <label>Discount %</label>
          <input type="number" id="discountPct" min="0" step="0.01" value="0" style="width: 80px;" />
        </div>
        
        <div class="control-group" style="margin-bottom: 8px;">
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; min-width: auto;">
            <input type="checkbox" id="showBreakdownInReceipt" style="width: auto; margin: 0;" />
            <span style="font-size: 12px;">Include breakdown</span>
          </label>
          <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; min-width: auto;">
            <input type="checkbox" id="shorthandReceipt" style="width: auto; margin: 0;" checked />
            <span style="font-size: 12px;">Shorthand</span>
          </label>
        </div>
        
        <textarea id="receiptOut" spellcheck="false" class="receipt-output"></textarea>
        <div class="muted receipt-help">
          Output is plain text for easy paste into messages.
        </div>
        
        <div id="componentBreakdownWrap" style="margin-top: 12px;"></div>
      </div>
    </div>
  </div>

  <!-- Keyboard Shortcuts Help -->
  <div class="shortcuts-help">
    <button class="shortcuts-btn" id="shortcutsBtn" title="Keyboard shortcuts">?</button>
    <div class="shortcuts-popup" id="shortcutsPopup">
      <h4>üñ±Ô∏è Button Controls</h4>
      <div class="shortcut-row"><span>Add 1</span><span class="shortcut-key">Click</span></div>
      <div class="shortcut-row"><span>Add 5</span><span class="shortcut-key">Shift+Click</span></div>
      <div class="shortcut-row"><span>Remove 1</span><span class="shortcut-key">Right-click</span></div>
      <div class="shortcut-row"><span>Remove 5</span><span class="shortcut-key">Shift+Right</span></div>
      <h4 style="margin-top: 10px;">‚å®Ô∏è Keyboard</h4>
      <div class="shortcut-row"><span>Clear order</span><span class="shortcut-key">Esc</span></div>
      <div class="shortcut-row"><span>Focus search</span><span class="shortcut-key">/</span></div>
      <div class="shortcut-row"><span>Copy receipt</span><span class="shortcut-key">Ctrl+Shift+C</span></div>
      <div class="shortcut-row"><span>Repeat last order</span><span class="shortcut-key">Ctrl+Shift+L</span></div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>